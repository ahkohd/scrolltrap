!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.scrolltrap=t()}(this,function(){var e=function(){function e(){}return e.attach=function(t,n){var o={el:t,token:e.generateToken(),options:n||{}};return e.elements.push(o),t.addEventListener("mouseleave",e.mouseLeave),t.addEventListener("mouseenter",function(t){return e.mouseEnter(o)}),o.token},e.destroy=function(t){var n=e.elements.filter(function(e){return e.token===t})[0];n&&(e.elements.splice(e.elements.indexOf(n),1),n.el.removeEventListener("mouseleave",e.mouseLeave),n.el.removeEventListener("mouseenter",function(t){return e.mouseEnter}),e.elements.length||document.removeEventListener("wheel",e.trapWheel))},e.mouseEnter=function(t){e.debug&&console.log("mouse entered"),document.addEventListener("wheel",e.trapWheel),e.trapEngagementCheck(t),t.options.detectContentChanges&&!function(t){t.addEventListener("DOMNodeRemoved DOMNodeInserted input",e.domChanged)}(t.el)},e.mouseLeave=function(t){e.debug&&console.log("mouse left"),document.removeEventListener("wheel",e.trapWheel),document.removeEventListener("DOMNodeRemoved DOMNodeInserted input",e.domChanged),document.body.classList.remove(e.defaultTrapClassName),e.trappedElement&&e.trappedElement.options.classname&&e.trappedElement.el.classList.remove(e.trappedElement.options.classname),e.trappedElement=null},e.domChanged=function(t){e.debug&&console.log(t.type),e.listenerToken&&clearTimeout(e.listenerToken),e.listenerToken=setTimeout(function(){e.refresh(e.trappedElement),e.listenerToken=null},100)},e.refresh=function(t){t&&e.trapEngagementCheck(t)},e.trapEngagementCheck=function(t){var n=t.el,o=n.clientHeight,s=n.scrollHeight;s>o?(document.body.classList.add(e.defaultTrapClassName),e.trappedElement=t):(document.body.classList.remove(e.defaultTrapClassName),e.trappedElement=null)},e.trapWheel=function(t){if(!document.body.classList.contains(e.defaultTrapClassName))return e.trappedElement.options.classname&&e.trappedElement.el.classList.remove(e.trappedElement.options.classname),!0;var n=e.trappedElement.el,o=n.scrollTop,s=t.deltaY;e.debug&&(console.log("delta-y: "+s),console.log("cursor scroll Pos: "+o));var l=n.clientHeight,r=n.scrollHeight,a=r-l;return e.debug&&(console.log("container height:"+l),console.log("content height:"+r),console.log("scrollable dist: "+a)),s>0&&(o>=a||o+1>=a)||s<0&&o<=0?(e.debug&&console.log("trapped"),e.trappedElement.options.classname&&e.trappedElement.el.classList.add(e.trappedElement.options.classname),t.preventDefault(),!1):void(e.trappedElement.options.classname&&e.trappedElement.el.classList.remove(e.trappedElement.options.classname))},e.generateToken=function(){var e=function(e){var t=(Math.random().toString(16)+"000000000").substr(2,8);return e?"-"+t.substr(0,4)+"-"+t.substr(4,4):t};return e()+e(!0)+e(!0)+e()},e}();return e.debug=!1,e.elements=[],e.defaultTrapClassName="trap-scroll-enabled",e});